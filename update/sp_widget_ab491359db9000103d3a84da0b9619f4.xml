<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[function($scope, spUtil) {
	/* widget controller */
	var c = this;
	c.data.loading = true;
	c.data.title = c.options.title || "List widget";
	c.data.table = c.options.table || "incident";
	c.data.query = c.options.query || "";
	c.data.template = c.options.template || "task-priority";

	$scope.server.update().then(function(){
		c.data.loading = false;
	})

	spUtil.recordWatch($scope, "incident", "numberANYTHING", function(name) {
		console.log(name.data.operation); 
		console.log(name); 
		// Calls a Client Script function to do the update and pass the updated data object
		// to the server.
		if(name.data.operation == "update"){
			c.snNoteUpdate(name, name.data.sys_id);
		}
		// Calls a Client Script function which does the update on the server and passes
		// the updated data object back to the client.
		if(name.data.operation == "delete"){
			c.snNoteDelete(name.data.sys_id);
		}
		// Replace the client data object with the server data object
		if(name.data.operation == "insert"){
			c.server.refresh();
		}
	});
}



]]></client_script>
        <controller_as>c</controller_as>
        <css>.accordion {
  background-color: #eee;
  color: #444;
  cursor: pointer;
  padding: 18px;
  width: 100%;
  border: none;
  text-align: left;
  outline: none;
  font-size: 15px;
  transition: 0.4s;
}

.active, .accordion:hover {
  background-color: #ccc; 
}

.frame {
  padding: 0 18px;
  display: none;
  background-color: white;
  overflow: hidden;
}</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list>title,color</field_list>
        <has_preview>true</has_preview>
        <id>list_widget</id>
        <internal>false</internal>
        <link><![CDATA[function() {
	var acc = document.getElementsByClassName("accordion");
	var i;

	for (i = 0; i < acc.length; i++) {
		acc[i].addEventListener("click", function() {
			this.classList.toggle("active");
			var frame = this.nextElementSibling;
			if (frame.style.display === "block") {
				frame.style.display = "none";
			} else {
				frame.style.display = "block";
			}
		});
	}
}]]></link>
        <name>list_widget</name>
        <option_schema>[{"name":"table","section":"other","default_value":"incident","label":"Table","type":"string"},{"name":"query","section":"other","label":"Query","type":"string"},{"name":"template","section":"other","label":"Template","type":"string"},{"name":"title","section":"Presentation","default_value":"List widget","label":"title","type":"string"}]</option_schema>
        <public>false</public>
        <roles/>
        <script><![CDATA[(function () {
	/* populate the 'data' object */
	/* e.g., data.table = $sp.getValue('table'); */

	if(input){
		//define the variable to hold our list	
		data.list = [];

		//Query the table
		var gr = new GlideRecord('incident');
		gr.addQuery('active', true)
		gr.addQuery('assigned_to', gs.getUser().getID());
		gr.orderByDesc('sys_created_on');
		gr.query()
		while (gr.next()) {
			//load values into object
			var recordObject = {};
			recordObject.number = gr.number.getDisplayValue();
			recordObject.short_description = gr.short_description.getDisplayValue();
			recordObject.priority = gr.priority.getDisplayValue();
			recordObject.category = gr.category.getDisplayValue();
			recordObject.assigned_to = gr.assigned_to.getDisplayValue();
			//add object to the list  
			data.list.push(recordObject);
		}
	}
})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2019-10-04 10:15:59</sys_created_on>
        <sys_id>ab491359db9000103d3a84da0b9619f4</sys_id>
        <sys_mod_count>118</sys_mod_count>
        <sys_name>list_widget</sys_name>
        <sys_package display_value="CreateNotes" source="x_snc_createnotes">df5fd9a5090232007f44e1046c8ff69f</sys_package>
        <sys_policy/>
        <sys_scope display_value="CreateNotes">df5fd9a5090232007f44e1046c8ff69f</sys_scope>
        <sys_update_name>sp_widget_ab491359db9000103d3a84da0b9619f4</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2019-10-14 14:17:49</sys_updated_on>
        <template><![CDATA[<div class="panel panel-{{c.options.color}}">
  <div class="panel-heading clearfix">
    <h4 class="panel-title pull-left">
      {{::c.options.title}}
    </h4>
  </div>
  <div class="panel-body"> 
    <span ng-if="c.data.loading"><i  class="fa fa-spinner fa-spin fa-3x fa-fw"></i>
      <span class="sr-only">Loading...</span></span>
    <input placeholder="Filter" class="form-control" ng-model="noteFilter" /> 
  </div>



  <button class="accordion">
    {{item.short_description}}
  </button>
  <div class="frame">
    <p>{{item.number}}</p>
    <p>{{item.priority}}</p>
  </div>

  <button class="accordion">Section 1</button>
  <div class="frame">
    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
  </div>

  <button class="accordion">Section 2</button>
  <div class="frame">
    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
  </div>

  <button class="accordion">Section 3</button>
  <div class="frame">
    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.</p>
  </div>
</div>]]></template>
    </sp_widget>
</record_update>
